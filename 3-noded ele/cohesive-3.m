
clear all;
%Equilibrium

%E1= (1/25)*[-5,0,0,5,0,5,0,0,-5;0,0,-5,0,5,5,0,-5,0]; %positive coordinate
%E2=(1/68)*[-1.8,0,11.8,6.8,0,-6.8,-5,0,-5;0,11.8,-1.8,0,-6.8,6.8,0,-5,-5];
%E3 =(1/93.16)*[6.8,0,6.9,0,0,-13.7,-6.8,0,6.8; 0,6.9,6.8,0,-13.7,0,0,6.8,-6.8];

E1 = (1/25)*[5, 0, 0, -5, 0, 5, 0, 0, -5; 0, 0, 5, 0, 5, -5, 0, -5, 0];
E2 = (1/68)*[0, 0, 11.8, -5, 0, -6.8, 5, 0, -5; 0, 11.8, 0, 0, -6.8, -5, 0, -5, 5];
E3 = (1/93.16)*[-5, 0, 6.9, 0, 0, -13.7, 5, 0 , 6.8; 0, 6.9, -5, 0, -13.7, 0, 0, 6.8, 5];
B_E=zeros(6,1);
A_E = zeros(6,27);
A_E(1:2,1:9)=E1;
A_E(3:4,10:18)=E2;
A_E(5:6,19:27)=E3;

%Discontinuity
D11 = [0.5, 0.5, -1; -0.5, 0.5, 0];

D22 = [0.5, 0.5, 1; 0.5, -0.5, 0];

A_D = zeros(8,27);
A_D(1:2,1:3)=D11;
A_D(1:2,10:12) = -D11;
A_D(3:4,7:9) = D11;
A_D(3:4,13:15) = -D11;
A_D(5:6,10:12) = D22;
A_D(5:6,19:21) = -D22;
A_D(7:8,16:18) = D22;
A_D(7:8,22:24) = -D22;

B_D=zeros(8,1);

%Boundary
B11 = [0, 0, 1, 0, 0, 0; 0, 0, 0, 0, 0, 1];
B22 = [0, 0, -1, 0, 0, 0; 0, 0, 0, 0, 0, -1];
B7 = [0, 1, 0;0,0,1];
B9 = [0,1,0;0,0,1];

A_B = zeros(8,27);
A_B(1:2, 1:6) = B11;
A_B(3:4,4:9) = B22;
A_B(5:6,19:21) = B7;
A_B(7:8,25:27)= B9;
B_B=zeros(8,1);

%Yield Condition
%p=6 c=20 gamma=18
Y1=[0.5,-0.5,1.732;  -0.5,0.5,1.732;  -1,1,0;   -0.5, 0.5, -1.732;   0.5, -0.5, -1.732;   1, -1, 0];
A_Y=zeros(27,27);
A_Y=kron(eye(9), Y1);
B_Y=repmat(34.64,54,1);

%Objective Function
C_z=zeros(21,1);
C_1=2.5*[0;1;0;0;1;0];
C=[C_1;C_z];

%Global matrix
%G_A1 = A_Y;
% G_A2_dash = zeros(5,27);
% G_B_dash = zeros(5,1);
G_A = [A_B;A_E;A_D;];
G_B = [B_B;B_E;B_D];


%Solution
f=-C;
%[x,fval]=linprog(f,G_A2,G_B);

[solution, fval] = linprog(f,A_Y,B_Y,G_A,G_B);
disp(fval/20);

