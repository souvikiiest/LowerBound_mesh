clear all;
clc;
%equilibirum element
E1 = (1/25)*[-5,0,0,0,0,5,5,0,-5; 0,0,-5,0,5,0,0,-5,5];
E2 = (1/68)*[-1.8,0,-11.8,-5,0,5,6.8,0,6.8; 0,-11.8,-1.8,0,5,-5,0,6.8,6.8];
E3 = (1/93.16)*[6.8,0,-6.8,-6.8,0,-6.8,0,0,13.7; 0,-6.8,6.8,0,-6.8,-6.8,0,13.7,0];

B_E=repmat([0;18],3,1); %gamma=0;
A_E = zeros(6,27);
A_E(1:2,1:9)=E1;
A_E(3:4,10:18)=E2;
A_E(5:6,19:27)=E3;

%Discontinuity
D11 = [0.5,0.5,-1; -0.5,0.5,0];

D22 = [0.5, 0.5, 1; 0.5, -0.5, 0];
A_D = zeros(8,27);
A_D(1:2,1:3)= D11;
A_D(1:2,10:12) = -D11;
A_D(3:4,4:6) = D11;
A_D(3:4,16:18) = -D11;
A_D(5:6,10:12) = D22;
A_D(5:6, 19:21) = -D22;
A_D(7:8,13:15) = D22;
A_D(7:8, 25:27)= -D22;

B_D=zeros(8,1);

%Boundary
B13 =[0,0,1];
B32 = [0,0,-1];
B97 = [0,1,0;0,0,1];

A_B = zeros(8,27);
A_B(1,1:3) = B13;
A_B(2,7:9) = B13;
A_B(3,7:9) = B32;
A_B(4,4:6) = B32;
A_B(5:6,19:21) = B97;
A_B(7:8, 22:24) = B97;

B_B=zeros(8,1);

%Yield Condition
%p=6 c=20 gamma=0
Y1=[0.5,-0.5,1.732;  -0.5,0.5,1.732;  -1,1,0;   -0.5, 0.5, -1.732;   0.5, -0.5, -1.732;   1, -1, 0];
A_Y=zeros(27,27);
A_Y=kron(eye(9), Y1);
B_Y=repmat(34.64,54,1);

%Objective Function
C_z=zeros(18,1);
C_1=2.5*[0;1;0;0;0;0;0;1;0];
C=[C_1;C_z];
%GLobal
G_A = [A_B;A_E;A_D;];
G_B = [B_B;B_E;B_D];


%Solution
g=-C;
%[x,fval]=linprog(f,G_A2,G_B);

[solution, fval,exitval,flag] = linprog(g,A_Y,B_Y,G_A,G_B);
disp(fval/(5*20));
disp(flag);